<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Quản lí sản phẩm</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta content="Responsive bootstrap 4 admin template" name="description" />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- App favicon -->
    <link
      href="https://img.cdn.vncdn.io/cdn-pos/f8f19b-53936/store/20190718_dMIPi931p7zUMwwzEZleqdMk.png"
      rel="icon"
      type="image/vnd.microsoft.icon"
    />

    <!-- App css -->
    <link
      href="assets\css\bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
      id="bootstrap-stylesheet"
    />
    <link href="assets\css\icons.min.css" rel="stylesheet" type="text/css" />
    <link
      href="assets\css\app.min.css"
      rel="stylesheet"
      type="text/css"
      id="app-stylesheet"
    />
    <link rel="stylesheet" href="../css/style2.css">
  </head>

  <body>
    <!-- Begin page -->
    <div id="wrapper">
      <!-- Topbar Start -->
      <div class="navbar-custom" style="background-color: #1939bc;">
        <ul class="list-unstyled topnav-menu float-right mb-0">

            <li class="dropdown notification-list dropdown d-none d-lg-inline-block ml-2">
                
                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\germany.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">German</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\italy.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Italian</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\spain.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Spanish</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <img src="assets\images\flags\russia.jpg" alt="lang-image" class="mr-1" height="12"> <span class="align-middle">Russian</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle  waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="mdi mdi-bell-outline noti-icon"></i>
                    <span class="noti-icon-badge"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="font-16 text-white m-0">
                            <span class="float-right">
                                <a href="" class="text-white">
                                    <small>Clear All</small>
                                </a>
                            </span>Notification
                        </h5>
                    </div>

                    <div class="slimscroll noti-scroll">

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-success">
                                <i class="mdi mdi-settings-outline"></i>
                            </div>
                            <p class="notify-details">New settings
                                <small class="text-muted">There are new settings available</small>
                            </p>
                        </a>
            
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-info">
                                <i class="mdi mdi-bell-outline"></i>
                            </div>
                            <p class="notify-details">Updates
                                <small class="text-muted">There are 2 new updates available</small>
                            </p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-danger">
                                <i class="mdi mdi-account-plus"></i>
                            </div>
                            <p class="notify-details">New user
                                <small class="text-muted">You have 10 unread messages</small>
                            </p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-info">
                                <i class="mdi mdi-comment-account-outline"></i>
                            </div>
                            <p class="notify-details">Caleb Flakelar commented on Admin
                                <small class="text-muted">4 days ago</small>
                            </p>
                        </a>

                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-secondary">
                                <i class="mdi mdi-heart"></i>
                            </div>
                            <p class="notify-details">Carlos Crouch liked
                                <b>Admin</b>
                                <small class="text-muted">13 days ago</small>
                            </p>
                        </a>
                    </div>

                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle  waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="mdi mdi-email-outline noti-icon"></i>
                    <span class="noti-icon-badge"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-lg">

                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="font-16 text-white m-0">
                            <span class="float-right">
                                <a href="" class="text-white">
                                    <small>Clear All</small>
                                </a>
                            </span>Messages
                        </h5>
                    </div>

                    <div class="slimscroll noti-scroll">

                        <div class="inbox-widget">
                            <a href="#">
                                <div class="inbox-item">
                                    <div class="inbox-item-img"><img src="assets\images\users\avatar-1.jpg" class="rounded-circle" alt=""></div>
                                    <p class="inbox-item-author">Chadengle</p>
                                    <p class="inbox-item-text text-truncate">Hey! there I'm available...</p>
                                </div>
                            </a>
                            <a href="#">
                                <div class="inbox-item">
                                    <div class="inbox-item-img"><img src="assets\images\users\avatar-2.jpg" class="rounded-circle" alt=""></div>
                                    <p class="inbox-item-author">Tomaslau</p>
                                    <p class="inbox-item-text text-truncate">I've finished it! See you so...</p>
                                </div>
                            </a>
                            <a href="#">
                                <div class="inbox-item">
                                    <div class="inbox-item-img"><img src="assets\images\users\avatar-3.jpg" class="rounded-circle" alt=""></div>
                                    <p class="inbox-item-author">Stillnotdavid</p>
                                    <p class="inbox-item-text text-truncate">This theme is awesome!</p>
                                </div>
                            </a>
                            <a href="#">
                                <div class="inbox-item">
                                    <div class="inbox-item-img"><img src="assets\images\users\avatar-4.jpg" class="rounded-circle" alt=""></div>
                                    <p class="inbox-item-author">Kurafire</p>
                                    <p class="inbox-item-text text-truncate">Nice to meet you</p>
                                </div>
                            </a>
                            <a href="#">
                                <div class="inbox-item">
                                    <div class="inbox-item-img"><img src="assets\images\users\avatar-5.jpg" class="rounded-circle" alt=""></div>
                                    <p class="inbox-item-author">Shahedk</p>
                                    <p class="inbox-item-text text-truncate">Hey! there I'm available...</p>

                                </div>
                            </a>
                        </div> <!-- end inbox-widget -->

                    </div>
                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-primary notify-item notify-all">
                        View all
                        <i class="fi-arrow-right"></i>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle nav-user mr-0 waves-effect waves-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <img src="../img/corgi.jpg" alt="user-image" class="rounded-circle">
                    <span class="d-none d-sm-inline-block ml-1 font-weight-medium">DuowngM</span>
                    <i class="mdi mdi-chevron-down d-none d-sm-inline-block"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-right profile-dropdown ">
                    <!-- item-->
                    <div class="dropdown-header noti-title">
                        <h6 class="text-overflow text-white m-0">Welcome !</h6>
                    </div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-account-outline"></i>
                        <span>Profile</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-settings-outline"></i>
                        <span>Settings</span>
                    </a>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-lock-outline"></i>
                        <span>Lock Screen</span>
                    </a>

                    <div class="dropdown-divider"></div>

                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="mdi mdi-logout-variant"></i>
                        <span>Logout</span>
                    </a>

                </div>
            </li>

            <li class="dropdown notification-list">
                <a href="javascript:void(0);" class="nav-link right-bar-toggle waves-effect waves-light">
                    <i class="mdi mdi-settings-outline noti-icon"></i>
                </a>
            </li>

        </ul>

        <!-- LOGO -->
        <div class="logo-box">
            <a href="index.html" class="logo text-center logo-dark" target="_blank">
                <span class="logo-lg">
                    <img src="../img/logo_1616402062_Logo web-01.png" alt="" height="60">
                    <!-- <span class="logo-lg-text-dark">Uplon</span> -->
                </span>
                <span class="logo-sm">
                    <!-- <span class="logo-lg-text-dark">U</span> -->
                    <img src="assets\images\logo-sm.png" alt="" height="24">
                </span>
            </a>

            <a href="index.html" class="logo text-center logo-light">
                <span class="logo-lg">
                    <img src="assets\images\logo-light.png" alt="" height="22">
                    <!-- <span class="logo-lg-text-dark">Uplon</span> -->
                </span>
                <span class="logo-sm">
                    <!-- <span class="logo-lg-text-dark">U</span> -->
                    <img src="assets\images\logo-sm-light.png" alt="" height="24">
                </span>
            </a>
        </div>

        <ul class="list-unstyled topnav-menu topnav-menu-left m-0">
            <li>
                <button class="button-menu-mobile waves-effect waves-light">
                    <i class="mdi mdi-menu"></i>
                </button>
            </li>

            <li class="d-none d-sm-block">
                <form class="app-search">
                    <div class="app-search-box">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Search...">
                            <div class="input-group-append">
                                <button class="btn" type="submit">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </li>
        </ul>
    </div>
      <div class="left-side-menu" style="background-color: #1939bc;">
        <div class="slimscroll-menu">
          <!--- Sidemenu -->
          <div id="sidebar-menu">
            <ul class="metismenu" id="side-menu">
              <li class="menu-title" style="color: #fff">Navigation</li>
              <li>
                <a href="adminProductne.html">
                  <i class="mdi mdi-view-dashboard" style="color: #fff"></i>
                  <span style="color:#fff; font-weight: 500;"> Quản lí sản phẩm </span>
                </a>
              </li>
              <li>
                <a href="adminUserne.html">
                  <i class="fa-solid fa-user" style="color: #fff"></i>
                  <span  style="color:#fff; font-weight: 500;"> Quản lí người dùng </span>
                </a>
              </li>
              <li>
                <a href="quanlydonhang.html">
                  <i class="fa-solid fa-cart-shopping" style="color: #fff"></i>
                  <span  style="color:#fff; font-weight: 500;"> Quản lí đơn hàng </span>
                </a>
              </li>
            </ul>
          </div>
          <!-- End Sidebar -->
        </div>
        <!-- Sidebar -left -->
      </div>
      <div class="content-page">
        <div class="content">
          <!-- Start Content-->
          <div class="container-fluid">
            <!-- start page title -->
            <div class="row">
              <div class="col-12">
                <div class="page-title-box">
                  <h4 class="page-title" style=" font-size: 50px;">Quản lí sản phẩm</h4>
                </div>
                <div class="product">
                  <div class="crud">
                    <h3>Thông tin sản phẩm</h3>
                    <table style="font-size: 20px; color: #000000">
                      <tr>
                        <td style="padding-bottom: 20px">Tên sản phẩm</td>
                        <td style="padding-bottom: 20px">
                          <input type="text" id="nameProduct" style="outline: none" />
                        </td>
                      </tr>
                      <tr>
                        <td style="padding-bottom: 20px">Ảnh sản phẩm</td>
                        <td style="padding-bottom: 20px">
                          <!-- <input
                            type="file"
                            id="imgProduct"
                            onchange="changeImg(this)"
                            style="outline: none"
                          />
                          <img id="image" src="" alt="" width="100px" height="100px"> -->
                          <input type="file" id="imgProduct" style="outline: none" />
                          <img id="image" src="" alt="" width="100px" height="100px" />
                        </td>
                      </tr>
                      <tr>
                        <td style="padding-bottom: 20px">Giá sản phẩm</td>
                        <td style="padding-bottom: 20px">
                          <input type="text" id="priceProduct" style="outline: none" />
                        </td>
                      </tr>
                      <tr>
                        <td style="padding-bottom: 20px">Số lượng</td>
                        <td style="padding-bottom: 20px">
                          <input type="text" id="sl" />
                        </td>
                      </tr>
                    </table>
                    <div class="buttonSave">
                      <button class="btn btn-success"
                        onclick="saveButton()"
                      >
                        Save
                      </button>
                      <button class="btn btn-success" onclick="editAll()">Chỉnh sửa</button>
                    </div>
                  </div>
                  <div class="productAdded">
                    <h3>Sản phẩm đã được thêm</h3>
                    <table id="tableAdded" style="text-align: center; font-size: 20px">
                      <!-- <tr>
                      <td>Tên</td>
                      <td>Ảnh</td>
                      <td>Giá</td>
                      <td>Mô tả</td>
                    </tr> -->
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <footer class="footer">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-12">
                DuowngM
              </div>
            </div>
          </div>
        </footer>
      </div>
      <script>
        const myImage = document.getElementById("image");
// Lắng nghe sự kiện onchange của input
        const imageInput = document.getElementById("imgProduct");

          imageInput.onchange = function (event) {
        const file = event.target.files[0];

          // Đọc tệp ảnh và chuyển đổi nó thành dữ liệu URL
        const reader = new FileReader();
          reader.onload = function (event) {
        const dataUrl = event.target.result;

            // Thiết lập nguồn ảnh của đối tượng ảnh với dữ liệu URL
            myImage.src = dataUrl;

            // Lưu dữ liệu URL vào local storage
            localStorage.setItem("myImage", dataUrl);

            // // Hiển thị ảnh
            // imgElement.src = dataUrl;
          };
          reader.readAsDataURL(file);
      };
      function makeCode() {
      var today = new Date();
      var day = today.getDay();
      var dd = today.getDate();
      var mm = today.getMonth() + 1;
      var yyyy = String(today.getFullYear());
      var h = today.getHours();
      var m = today.getMinutes();
      var s = today.getSeconds();
      m = checkTime(m);
      s = checkTime(s);
      if (dd < 10) {
        dd = '0' + dd
      }
      if (mm < 10) {
        mm = '0' + mm
      }
      function checkTime(i) {
        if (i < 10) {
          i = "0" + i;
        }
        return i;
      }
      return result = yyyy + mm + dd + h + m + s;
    }

      let listProduct = JSON.parse(localStorage.getItem("listProduct"));
      function saveButton() {
        makeCode();
        let id = result;
        let nameProductInput = document.getElementById("nameProduct").value;
        let imgInput = localStorage.getItem("myImage");
        let priceProductInput = document.getElementById("priceProduct").value;
        let numberProduct = document.getElementById("sl").value;
        let product = {
          ID: id,
          img: imgInput,
          ten: nameProductInput,
          gia: priceProductInput,
          soluong: numberProduct,
        };
        let flag = JSON.parse(localStorage.getItem("flag"));
        if (flag != null) {
          listProduct.splice(flag, 1, product);
          localStorage.removeItem("flag");
          renderProduct();
          idInput = document.getElementById("aidi").value = "";
          nameProductInput = document.getElementById("nameProduct").value = "";
          priceProductInput = document.getElementById("priceProduct").value =
            "";
          numberProduct = document.getElementById("sl").value = "";
          localStorage.setItem("listProduct", JSON.stringify(listProduct));
          return;
        }
        if (listProduct == null) {
          listProduct = [];
          listProduct.push(product);
          localStorage.setItem("listProduct", JSON.stringify(listProduct));
        } else {
          listProduct.push(product);
          localStorage.setItem("listProduct", JSON.stringify(listProduct));
        }
        nameProductInput = document.getElementById("nameProduct").value="";
        priceProductInput = document.getElementById("priceProduct").value="";
        numberProduct = document.getElementById("sl").value="";
        renderProduct();
      }
      renderProduct();

      function renderProduct() {
        let total = `
          <tr class="tr1">
            <td class="td1">ID</td>
            <td class="td1">Ảnh</td>
            <td class="td1">Tên</td>
            <td class="td1">Giá</td>
            <td class="td1">Số lượng</td>
            <td class="td1" colspan="2">Tính năng</td>
          </tr>
      `;
        for (let i = 0; i < listProduct.length; i++) {
          total += `
          <tr class="tr1">
            <td class="td1">${listProduct[i].ID}</td>
            <td class="td1"><img src="${listProduct[i].img}" alt="${listProduct[i].ten}" width="100px" height="100px" /></td>
            <td class="td1">${listProduct[i].ten}</td>
            <td class="td1">${listProduct[i].gia}</td>
            <td class="td1">${listProduct[i].soluong}</td>
            <td class="td1"><button class="buttonNe" onclick="editButton(${i})">Edit</button></td>
            <td class="td1"><button class="buttonNe" onclick="deleteButton(${i})">Delete</button>
              </td>
          </tr>
      `;
        }
        document.getElementById("tableAdded").innerHTML = total;
      }
      function deleteButton(id) {
        listProduct.splice(id, 1);
        localStorage.setItem("listProduct", JSON.stringify(listProduct));
        renderProduct();
      }
      function editButton(id) {
        nameProductInput = document.getElementById("nameProduct").value =
          listProduct[id].ten;
        priceProductInput = document.getElementById("priceProduct").value =
          listProduct[id].gia;
        numberProduct = document.getElementById("sl").value =
          listProduct[id].soluong;
          myImage.src = listProduct[id].img;
        localStorage.setItem("flag", id);
      }
      function editAll() {
      let id = localStorage.getItem("flag");
      listProduct[id].ten = document.getElementById("nameProduct").value;
      listProduct[id].gia = document.getElementById("priceProduct").value;
      listProduct[id].soluong = document.getElementById("sl").value;
      const newImage = localStorage.getItem("myImage");
       if (newImage !== null) {
          listProduct[id].img = newImage;
          localStorage.removeItem("myImage");
      }

      localStorage.setItem("listProduct", JSON.stringify(listProduct));
      const snackbar = document.createElement("div");
          snackbar.classList.add("snackbar");
          snackbar.innerText = "Đã cập nhật sản phẩm thành công ♥";
          document.body.appendChild(snackbar);

          setTimeout(() => {
            snackbar.remove();
          }, 3000);
    }
      </script>
  </body>
</html>
